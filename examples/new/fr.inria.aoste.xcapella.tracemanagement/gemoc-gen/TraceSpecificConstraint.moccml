AutomataConstraintLibrary temporalConstraints{
   import 'platform:/plugin/fr.inria.aoste.timesquare.ccslkernel.model/ccsllibrary/kernel.ccslLib' as kernel;

   RelationLibrary temporalRelations{

      AutomataRelationDefinition TraceSpecificConstraintDef[TraceSpecificConstraint]{

			variables { 
 				Integer un = 1
 				Integer currentTime = 0
 				Integer timeStamp1 = 1
 				Integer timeStamp2 = 3
 			}
	           init:  initialState
	           State initialState(out: s0s1)
	             from initialState to s1 : s0s1 -> ()
	           State s1(
	           		in: s1s1, s0s1
					out : s1s1, s1s2, s1s2bis, s1s2ter
			   )
				from s1 to s1 : s1s1 -> ( if (currentTime < timeStamp1) when TraceSpecificConstraint_phyClock do currentTime = (currentTime + un))
				from s1 to s2 : s1s2 -> ( if (currentTime == timeStamp1) when TraceSpecificConstraint_PreProcessing_ACTIVATED, TraceSpecificConstraint_T2_ACTIVATED, TraceSpecificConstraint_T2_STARTED)
				from s1 to s2 : s1s2bis -> ( if (currentTime == (timeStamp1 - un)) when TraceSpecificConstraint_PreProcessing_ACTIVATED, TraceSpecificConstraint_T2_ACTIVATED, TraceSpecificConstraint_T2_STARTED, TraceSpecificConstraint_phyClock do currentTime = (currentTime + un))
				from s1 to s2 : s1s2ter -> ( if (currentTime > timeStamp1) when TraceSpecificConstraint_phyClock do kill(TraceSpecificConstraint_phyClock))
	           State s2(
	           		in: s2s2, s1s2, s1s2bis, s1s2ter
					out : s2s2, s2s3, s2s3bis, s2s3ter
			   )
				from s2 to s2 : s2s2 -> ( if (currentTime < timeStamp2) when TraceSpecificConstraint_phyClock do currentTime = (currentTime + un))
				from s2 to s3 : s2s3 -> ( if (currentTime == timeStamp2) when TraceSpecificConstraint_T2_TERMINATED)
				from s2 to s3 : s2s3bis -> ( if (currentTime == (timeStamp2 - un)) when TraceSpecificConstraint_T2_TERMINATED , TraceSpecificConstraint_phyClock do currentTime = (currentTime + un))
				from s2 to s3 : s2s3ter -> ( if (currentTime > timeStamp2) when TraceSpecificConstraint_phyClock do kill(TraceSpecificConstraint_phyClock))
	           State s3(
	           		in: s2s3, s2s3bis,s2s3ter
					out: s3s4
			   )
				from s3 to s4 : s3s4 -> ( if (currentTime > un)                              do kill(TraceSpecificConstraint_PreProcessing_ACTIVATED)
                             do kill(TraceSpecificConstraint_AicraftPosition_ACTIVATED)
                             do kill(TraceSpecificConstraint_T6_ACTIVATED)
                             do kill(TraceSpecificConstraint_T6_STARTED)
                             do kill(TraceSpecificConstraint_T6_SUSPENDED)
                             do kill(TraceSpecificConstraint_T6_TERMINATED)
                             do kill(TraceSpecificConstraint_T7_ACTIVATED)
                             do kill(TraceSpecificConstraint_T7_STARTED)
                             do kill(TraceSpecificConstraint_T7_SUSPENDED)
                             do kill(TraceSpecificConstraint_T7_TERMINATED)
                             do kill(TraceSpecificConstraint_T5_ACTIVATED)
                             do kill(TraceSpecificConstraint_T5_STARTED)
                             do kill(TraceSpecificConstraint_T5_SUSPENDED)
                             do kill(TraceSpecificConstraint_T5_TERMINATED)
                             do kill(TraceSpecificConstraint_T2_ACTIVATED)
                             do kill(TraceSpecificConstraint_T2_STARTED)
                             do kill(TraceSpecificConstraint_T2_SUSPENDED)
                             do kill(TraceSpecificConstraint_T2_TERMINATED)
						)
	           State s4(
                            in: s3s4			   )
}

RelationDeclaration	TraceSpecificConstraint(TraceSpecificConstraint_phyClock:clock,TraceSpecificConstraint_PreProcessing_ACTIVATED:clock,TraceSpecificConstraint_AicraftPosition_ACTIVATED:clock,TraceSpecificConstraint_T6_ACTIVATED:clock,TraceSpecificConstraint_T6_STARTED:clock,TraceSpecificConstraint_T6_SUSPENDED:clock,TraceSpecificConstraint_T6_TERMINATED:clock,TraceSpecificConstraint_T7_ACTIVATED:clock,TraceSpecificConstraint_T7_STARTED:clock,TraceSpecificConstraint_T7_SUSPENDED:clock,TraceSpecificConstraint_T7_TERMINATED:clock,TraceSpecificConstraint_T5_ACTIVATED:clock,TraceSpecificConstraint_T5_STARTED:clock,TraceSpecificConstraint_T5_SUSPENDED:clock,TraceSpecificConstraint_T5_TERMINATED:clock,TraceSpecificConstraint_T2_ACTIVATED:clock,TraceSpecificConstraint_T2_STARTED:clock,TraceSpecificConstraint_T2_SUSPENDED:clock,TraceSpecificConstraint_T2_TERMINATED:clock)
	           }
}
